#!/bin/sh

cd /usr/lib/meld/meld/
echo "Patching files in $(pwd)"

sed '
s/\(color_delete_bg"[^"]*\)"[^"]*"/\1"#003300"/
s/\(color_replace_bg"[^"]*\)"[^"]*"/\1"#112233"/
s/\(color_replace_fg"[^"]*\)"[^"]*"/\1"gray80"/
s/\(color_conflict_fg"[^"]*\)"[^"]*"/\1"White"/
s/\(color_inline_bg"[^"]*\)"[^"]*"/\1"#223344"/
s/\(color_inline_fg"[^"]*\)"[^"]*"/\1"White"/
s/\(color_edited_bg"[^"]*\)"[^"]*"/\1"gray20"/
s/\(color_edited_fg"[^"]*\)"[^"]*"/\1"White"/
' preferences.py > preferences.py.new

sed '
s/foreground="[^"]*"\([^#]*#[ ]*STATE_NORMAL\)/foreground="white"\1/
s/foreground="[^"]*"\([^#]*#[ ]*STATE_NOCHANGE\)/foreground="white"\1/
' tree.py > tree.py.new

for file in preferences.py tree.py; do
	mv "$file.new" "$file"
done

echo -e "\e[32;1mDone\e[0m (Note: In case meld doesn't work anymore, please reinstall it.)"
